"use strict";var jq=jQuery,userGuideDisplayModal=void 0,userGuideEditModal=void 0;function slugify(e){return e.toString().toLowerCase().replace(/\s+/g,"-").replace(/[^\w\-]+/g,"").replace(/\-\-+/g,"-").replace(/^-+/,"").replace(/-+$/,"")}function updateUserGuideEditFields(){var e=500;"template"===jq('#user_guide_edit_form select[name="format"]').val()?(jq("#user_guide_edit_form #templatePath-field").show(e),jq("#user_guide_edit_form #content-field").hide(e)):(jq("#user_guide_edit_form #templatePath-field").hide(e),jq("#user_guide_edit_form #content-field").show(e))}if(jq(".guide_cp").length>0){var guideSubNav="";jq("html").addClass("guide-cp"),jq("#nav-guidehome > a").addClass("sel"),jq("h1[data-guide-section], h2[data-guide-section], h3[data-guide-section], h4[data-guide-section]").each(function(){var e=this.innerText,i=slugify(e),s=this.tagName.toLowerCase();console.log(s),jq(this).attr("id","guide-section-"+i),guideSubNav+='<a href="#guide-section-'+i+'" class="'+s+'">'+e+"</a>"}),""!==guideSubNav&&(jq("#header .guide_action_buttons").append('<span id="user_guide_cp__sections" class="guide_button btn">Sections</span>'),jq("#header").append('<nav id="guide__subnav" class="guide__subnav"><div id="guide__subnav_links" class="guide__subnav_links">'+guideSubNav+"</div></nav>"),jq("#user_guide_cp__sections").click(function(){jq("#guide__subnav_links").toggleClass("guide__subnav_links--active"),jq("#guide__subnav").css("top",jq("#header").outerHeight())}),jq("#guide__subnav_links").mouseleave(function(){jq(this).removeClass("guide__subnav_links--active")})),jq(".guide__subnav_links a").click(function(){return event.preventDefault(),jq("#content-container").animate({scrollTop:jq("#content-container").scrollTop()+jq(jq.attr(this,"href")).offset().top-jq("#header").outerHeight()-20},600),!1})}function deleteUserGuide(e){Craft.postActionRequest("guide/user-guide/delete-user-guide",e,function(e,i,s){console.log(i),"success"===i&&(jq(".guide_cp__btn_show_user_guide").addClass("guide__hidden"),jq(".guide_cp__btn_show_user_guide_edit > span:first-child").addClass("guide__hidden"),jq(".guide_cp__btn_show_user_guide_edit > span:last-child").removeClass("guide__hidden"),userGuideEditModal.hide())})}function saveUserGuide(e){Craft.postActionRequest("guide/user-guide/save-user-guide",e,function(i,s,d){"success"===s&&(jq(".guide_cp__btn_show_user_guide").removeClass("guide__hidden").text("Preview"),jq(".guide_cp__btn_show_user_guide_edit > span:first-child").removeClass("guide__hidden"),jq(".guide_cp__btn_show_user_guide_edit > span:last-child").addClass("guide__hidden"),userGuideEditModal.hide(),Craft.postActionRequest("guide/user-guide/get-user-guide-body",e,function(e,i,s){"success"===i&&jq(userGuideDisplayModal.$container).find(".guide__modal__content").html(e.guideAsString)}))})}function updateGuideThemeDemo(){jq("#settings-guide__demo__css").html("<style>"+jq("#settings-customCss").val()+"</style>")}jq(".guide_cp__btn_show_user_guide").length>0&&jq("#guide_cp__user_guide").length>0&&(userGuideDisplayModal=new Garnish.Modal(jq("#guide_cp__user_guide > div"),{autoShow:!1,resizable:!0}),jq(".guide_cp__btn_show_user_guide").click(function(){userGuideDisplayModal.show()})),jq(".guide_cp__btn_show_user_guide_edit").length>0&&jq("#guide_cp__user_guide_edit").length>0&&(userGuideEditModal=new Garnish.Modal(jq("#guide_cp__user_guide_edit > div"),{autoShow:!1,resizable:!0}),updateUserGuideEditFields(),jq('#user_guide_edit_form select[name="format"]').change(updateUserGuideEditFields),jq(".guide_cp__btn_show_user_guide_edit").click(function(){userGuideEditModal.show()}),jq("#user_guide_edit_form").unbind("submit").submit(function(e){return e.preventDefault(),saveUserGuide(jq(this).serialize()),!1}),jq('#user_guide_edit_form input[type="submit"]').unbind("click").click(function(e){switch(e.preventDefault(),jq(this).attr("id")){case"user_guide_edit_form__delete":deleteUserGuide(jq("#user_guide_edit_form").serialize());break;case"user_guide_edit_form__save":saveUserGuide(jq("#user_guide_edit_form").serialize())}return!1})),jq("#settings-guide__demo__css").length>0&&jq("#settings-customCss").length>0&&(jq("#settings-customCss").change(updateGuideThemeDemo),jq("#settings-customCss").on("input propertychange",updateGuideThemeDemo));